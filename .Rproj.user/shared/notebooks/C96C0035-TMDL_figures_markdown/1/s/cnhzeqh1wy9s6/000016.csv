"0","if(""TMDL""%in%colnames(output)){"
"0","  ldc=output"
"0","ldc_month = subset(ldc, !is.na(ldc$Observed_Loading))"
"0","ldc_month = ldc_month%>%select(Date,MonitoringLocationIdentifier,TMDL,Observed_Loading)%>%pivot_longer(cols=c(TMDL,Observed_Loading),names_to=""Type"",values_to=""Loading"",values_drop_na=TRUE)"
"0","ldc_month$Loading_Giga = ldc_month$Loading/1000000000"
"0","ldc_month$month = lubridate::month(ldc_month$Date, label=TRUE, abbr=TRUE)"
"0",""
"0","ldc_month1 = ldc_month%>%dplyr::group_by(MonitoringLocationIdentifier,Type,month)%>%dplyr::summarise(mean_Load = gmean(Loading_Giga))"
"0",""
"0","ldcsites = unique(ldc_month1$MonitoringLocationIdentifier)"
"0","for(i in 1:length(ldcsites)){"
"0","  name = ldcsites[i]"
"0","  g = ggplot(ldc_month1, aes(x=month, y=mean_Load, fill=Type))+geom_blank()+theme_classic()+geom_rect(aes(xmin=4.5,ymin=0,xmax=10.5,ymax=max(ldc_month1$mean_Load*1.1)), fill=""#D3D3D3"")+scale_x_discrete(limits=month.abb)+labs(x=""Month"",y=""GigaMPN/day"")+geom_col(position=""dodge"", color=""#646464"")+scale_fill_manual(values=c(""#00a1c6"",""#034963""),name="""",breaks=c(""Observed_Loading"",""TMDL""),labels=c(""Observed"",""TMDL""))+guides(color=""none"")"
"0","  g"
"0","  ggsave(paste0(name,""_monthly_load.jpg""),width=8,height=4, units=""in"", dpi=500)"
"0","}"
"0","g"
"0","}"
