"0","gmean = function(x){exp(mean(log(x)))}"
"0","dat = output"
"0","dat_agg = output%>%group_by(MonitoringLocationIdentifier, CharacteristicName,ResultMeasure.MeasureUnitCode)%>%summarise(daterange = paste0(min(Date),"" to "",max(Date)),samplesize=length(DailyResultMeasureValue),minconc = min(DailyResultMeasureValue),arithmean=mean(DailyResultMeasureValue),maxconc = max(DailyResultMeasureValue), perc_exc = sum(Exceeds)/length(Exceeds)*100)"
"0","rec_mean = output%>%filter(Rec_Season==""rec"")%>%group_by(MonitoringLocationIdentifier, CharacteristicName,ResultMeasure.MeasureUnitCode)%>%summarise(rec_ssn_arithmean=mean(DailyResultMeasureValue),rec_ssn_perc_exc = sum(Exceeds)/length(Exceeds)*100)"
"0","dat_agg = merge(dat_agg, rec_mean, all = TRUE)"
"0","if(aggFun==""gmean""){"
"0","  dat_agg_geo = output%>%group_by(MonitoringLocationIdentifier, CharacteristicName, ResultMeasure.MeasureUnitCode)%>%summarise(geomean = gmean(DailyResultMeasureValue))"
"0","  rec_geo = output%>%filter(Rec_Season==""rec"")%>%group_by(MonitoringLocationIdentifier, CharacteristicName, ResultMeasure.MeasureUnitCode)%>%summarise(rec_ssn_geomean=gmean(DailyResultMeasureValue))"
"0","  dat_agg_geo = merge(dat_agg_geo, rec_geo, all = TRUE)"
"0","}"
"0","dat_agg = merge(dat_agg, dat_agg_geo, all = TRUE)"
"0","if(""DailyFlowValue""%in%colnames(output)){"
"0","  flo_agg = output%>%filter(!is.na(DailyFlowValue))%>%group_by(MonitoringLocationIdentifier, ResultMeasure.MeasureUnitCode)%>%summarise(daterange = paste0(min(Date),"" to "",max(Date)),samplesize=length(DailyFlowValue),minconc = min(DailyFlowValue),arithmean=mean(DailyFlowValue),maxconc = max(DailyFlowValue))"
"0","  dat_agg = plyr::rbind.fill(dat_agg, flo_agg)"
"0","  dat_agg$CharacteristicName[is.na(dat_agg$CharacteristicName)] = ""Flow"""
"0","}"
"0","write.csv(dat_agg, paste0(au_name,""_summary_table_stats.csv""), row.names = FALSE)"
"0","head(dat_agg)"
